language: php
sudo: "required"

cache:
  directories:
    - $HOME/.composer/cache
    - $HOME/symfony-bridge/.phpunit

warnings_are_errors: false

services:
  - "docker"

before_install:
  - "./.travis/main.sh"

install:
  - "make install-project-test"

script:
  - "make test"
  - "make image"

php:
  - 7.3

after_success:
  - if [[ "$TRAVIS_BRANCH" == "master" ]]; then
    docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD ;
    make push-image ;
    fi

notifications:
  email: false
